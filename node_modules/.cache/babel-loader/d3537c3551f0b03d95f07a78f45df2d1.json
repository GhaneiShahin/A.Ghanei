{"ast":null,"code":"var deprecate = require('depd')('hsts');\n\nvar DEFAULT_MAX_AGE = 180 * 24 * 60 * 60;\n\nmodule.exports = function hsts(options) {\n  options = options || {};\n\n  if ('includeSubdomains' in options) {\n    deprecate('The \"includeSubdomains\" parameter is deprecated. Use \"includeSubDomains\" (with a capital D) instead.');\n  }\n\n  if ('setIf' in options) {\n    deprecate('The \"setIf\" parameter is deprecated. Refer to the documentation to see how to set the header conditionally.');\n  }\n\n  var maxAge = options.maxAge != null ? options.maxAge : DEFAULT_MAX_AGE;\n  var includeSubDomains = options.includeSubDomains !== false && options.includeSubdomains !== false;\n  var setIf = options.hasOwnProperty('setIf') ? options.setIf : alwaysTrue;\n\n  if (options.hasOwnProperty('maxage')) {\n    throw new Error('maxage is not a supported property. Did you mean to pass \"maxAge\" instead of \"maxage\"?');\n  }\n\n  if (arguments.length > 1) {\n    throw new Error('HSTS passed the wrong number of arguments.');\n  }\n\n  if (typeof maxAge !== 'number') {\n    throw new TypeError('HSTS must be passed a numeric maxAge parameter.');\n  }\n\n  if (maxAge < 0) {\n    throw new RangeError('HSTS maxAge must be nonnegative.');\n  }\n\n  if (typeof setIf !== 'function') {\n    throw new TypeError('setIf must be a function.');\n  }\n\n  if (options.hasOwnProperty('includeSubDomains') && options.hasOwnProperty('includeSubdomains')) {\n    throw new Error('includeSubDomains and includeSubdomains cannot both be specified.');\n  }\n\n  var header = 'max-age=' + Math.round(maxAge);\n\n  if (includeSubDomains) {\n    header += '; includeSubDomains';\n  }\n\n  if (options.preload) {\n    header += '; preload';\n  }\n\n  return function hsts(req, res, next) {\n    if (setIf(req, res)) {\n      res.setHeader('Strict-Transport-Security', header);\n    }\n\n    next();\n  };\n};\n\nfunction alwaysTrue() {\n  return true;\n}","map":null,"metadata":{},"sourceType":"script"}